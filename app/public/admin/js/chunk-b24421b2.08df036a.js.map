{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.function.name.js","webpack:///./src/views/Product.vue?076b","webpack:///src/views/Product.vue","webpack:///./src/views/Product.vue?ad6d","webpack:///./src/views/Product.vue"],"names":["DESCRIPTORS","defineProperty","f","FunctionPrototype","Function","prototype","FunctionPrototypeToString","toString","nameRE","NAME","configurable","get","call","this","match","error","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","$event","addDialogVisible","_v","selection","length","removeProducts","directives","name","rawName","value","expression","list","selectionChangeHandler","scopedSlots","_u","key","fn","scope","row","thumbnail","src","priceFormatter","dateFormatter","openEditDialog","pagesize","page","total","getProductList","mediaDialgVisible","ref","_e","slot","mediaDialogConfirm","addDialogCloseHandler","addDialogForm","addDialogRules","model","callback","$$v","$set","_n","addDialogLoading","addDialogConfirm","editDialogVisible","editDialogCloseHandler","editDialogForm","editDialogRules","editDialogLoading","editDialogConfirm","staticRenderFns","components","LeeMedia","data","loading","currentSelectMedia","price","editProductId","methods","media","products","$confirm","type","item","_id","$refs","resetFields","component"],"mappings":"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","file":"js/chunk-b24421b2.08df036a.js","sourcesContent":["var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.github.io/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-row',{staticClass:\"margin-bottom\",attrs:{\"type\":\"flex\",\"align\":\"middle\",\"justify\":\"end\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.addDialogVisible = true}}},[_vm._v(\"添加产品\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"disabled\":_vm.selection.length === 0},on:{\"click\":function($event){return _vm.removeProducts(_vm.selection)}}},[_vm._v(\"批量删除\")])],1),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"margin-bottom\",attrs:{\"data\":_vm.list,\"stripe\":\"\",\"border\":\"\"},on:{\"selection-change\":_vm.selectionChangeHandler}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"55\",\"align\":\"center\",\"fixed\":\"left\"}}),_c('el-table-column',{attrs:{\"label\":\"缩略图\",\"width\":\"120\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return _c('div',{staticClass:\"thumbnail\"},[_c('img',{attrs:{\"src\":scope.row.thumbnail.src}})])}}])}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"名称\",\"min-width\":\"160\"}}),_c('el-table-column',{attrs:{\"prop\":\"price\",\"label\":\"价格\",\"width\":\"160\",\"align\":\"center\",\"formatter\":_vm.priceFormatter}}),_c('el-table-column',{attrs:{\"prop\":\"createdAt\",\"label\":\"添加时间\",\"width\":\"160\",\"align\":\"center\",\"formatter\":_vm.dateFormatter}}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"center\",\"min-width\":\"160\",\"fixed\":\"right\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.openEditDialog(scope.row)}}},[_vm._v(\"编辑\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.removeProducts([scope.row])}}},[_vm._v(\"删除\")])]}}])})],1),_c('el-pagination',{attrs:{\"page-size\":_vm.pagesize,\"current-page\":_vm.page,\"total\":_vm.total},on:{\"current-change\":_vm.getProductList}}),_c('el-dialog',{attrs:{\"title\":\"媒体库\",\"visible\":_vm.mediaDialgVisible,\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.mediaDialgVisible=$event}}},[(_vm.mediaDialgVisible)?_c('lee-media',{ref:\"media\",attrs:{\"multiple\":false}}):_vm._e(),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.mediaDialogConfirm}},[_vm._v(\"确定\")]),_c('el-button',{on:{\"click\":function($event){_vm.mediaDialgVisible = false}}},[_vm._v(\"取消\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"添加产品\",\"visible\":_vm.addDialogVisible,\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.addDialogVisible=$event},\"closed\":_vm.addDialogCloseHandler}},[_c('el-form',{ref:\"addDialogForm\",attrs:{\"label-width\":\"80px\",\"label-position\":\"left\",\"model\":_vm.addDialogForm,\"rules\":_vm.addDialogRules}},[_c('el-form-item',{attrs:{\"label\":\"名称\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.addDialogForm.name),callback:function ($$v) {_vm.$set(_vm.addDialogForm, \"name\", $$v)},expression:\"addDialogForm.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"缩略图\",\"prop\":\"thumbnail\"}},[_c('el-button',{on:{\"click\":function($event){_vm.mediaDialgVisible = true}}},[_vm._v(\"从媒体库选择\")]),(_vm.currentSelectMedia)?_c('span',{staticClass:\"margin-left\"},[_vm._v(\"已选择\")]):_vm._e()],1),_c('el-form-item',{attrs:{\"label\":\"价格\",\"prop\":\"price\"}},[_c('el-input',{model:{value:(_vm.addDialogForm.price),callback:function ($$v) {_vm.$set(_vm.addDialogForm, \"price\", _vm._n($$v))},expression:\"addDialogForm.price\"}},[_c('span',{attrs:{\"slot\":\"append\"},slot:\"append\"},[_vm._v(\"元\")])])],1)],1),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.addDialogLoading},on:{\"click\":_vm.addDialogConfirm}},[_vm._v(\"确定\")]),_c('el-button',{on:{\"click\":function($event){_vm.addDialogVisible = false}}},[_vm._v(\"取消\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"编辑产品\",\"visible\":_vm.editDialogVisible,\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.editDialogVisible=$event},\"closed\":_vm.editDialogCloseHandler}},[_c('el-form',{ref:\"editDialogForm\",attrs:{\"label-width\":\"80px\",\"label-position\":\"left\",\"model\":_vm.editDialogForm,\"rules\":_vm.editDialogRules}},[_c('el-form-item',{attrs:{\"label\":\"名称\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.editDialogForm.name),callback:function ($$v) {_vm.$set(_vm.editDialogForm, \"name\", $$v)},expression:\"editDialogForm.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"缩略图\",\"prop\":\"thumbnail\"}},[_c('el-button',{on:{\"click\":function($event){_vm.mediaDialgVisible = true}}},[_vm._v(\"从媒体库选择\")]),(_vm.currentSelectMedia)?_c('span',{staticClass:\"margin-left\"},[_vm._v(\"已选择\")]):_vm._e()],1),_c('el-form-item',{attrs:{\"label\":\"价格\",\"prop\":\"price\"}},[_c('el-input',{model:{value:(_vm.editDialogForm.price),callback:function ($$v) {_vm.$set(_vm.editDialogForm, \"price\", _vm._n($$v))},expression:\"editDialogForm.price\"}},[_c('span',{attrs:{\"slot\":\"append\"},slot:\"append\"},[_vm._v(\"元\")])])],1)],1),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.editDialogLoading},on:{\"click\":_vm.editDialogConfirm}},[_vm._v(\"保存\")]),_c('el-button',{on:{\"click\":function($event){_vm.editDialogVisible = false}}},[_vm._v(\"取消\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <el-row class=\"margin-bottom\" type=\"flex\" align=\"middle\" justify=\"end\">\r\n      <el-button type=\"primary\" @click=\"addDialogVisible = true\">添加产品</el-button>\r\n      <el-button type=\"danger\" :disabled=\"selection.length === 0\"\r\n        @click=\"removeProducts(selection)\"\r\n      >批量删除</el-button>\r\n    </el-row>\r\n\r\n    <!-- 产品列表 -->\r\n    <el-table class=\"margin-bottom\" v-loading=\"loading\" :data=\"list\" stripe border\r\n      @selection-change=\"selectionChangeHandler\"\r\n    >\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" fixed=\"left\" />\r\n      <el-table-column label=\"缩略图\" width=\"120\">\r\n        <div class=\"thumbnail\" slot-scope=\"scope\">\r\n          <img :src=\"scope.row.thumbnail.src\">\r\n        </div>\r\n      </el-table-column>\r\n      <el-table-column prop=\"name\" label=\"名称\" min-width=\"160\" />\r\n      <el-table-column prop=\"price\" label=\"价格\" width=\"160\"\r\n        align=\"center\" :formatter=\"priceFormatter\" />\r\n      <el-table-column prop=\"createdAt\" label=\"添加时间\" width=\"160\"\r\n        align=\"center\" :formatter=\"dateFormatter\" />\r\n      <el-table-column label=\"操作\" align=\"center\" min-width=\"160\" fixed=\"right\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"primary\" size=\"mini\" @click=\"openEditDialog(scope.row)\">编辑</el-button>\r\n          <el-button type=\"danger\" size=\"mini\" @click=\"removeProducts([scope.row])\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- 产品列表END -->\r\n\r\n    <!-- 分页 -->\r\n    <el-pagination\r\n      :page-size=\"pagesize\"\r\n      :current-page=\"page\"\r\n      :total=\"total\"\r\n      @current-change=\"getProductList\"\r\n    ></el-pagination>\r\n    <!-- 分页END -->\r\n\r\n    <!-- 媒体库弹窗 -->\r\n    <el-dialog title=\"媒体库\" :visible.sync=\"mediaDialgVisible\" append-to-body>\r\n      <lee-media ref=\"media\" :multiple=\"false\" v-if=\"mediaDialgVisible\" />\r\n      <div slot=\"footer\">\r\n        <el-button type=\"primary\" @click=\"mediaDialogConfirm\">确定</el-button>\r\n        <el-button @click=\"mediaDialgVisible = false\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n    <!-- 媒体库弹窗END -->\r\n\r\n    <!-- 添加产品弹窗 -->\r\n    <el-dialog title=\"添加产品\" :visible.sync=\"addDialogVisible\" append-to-body \r\n      @closed=\"addDialogCloseHandler\">\r\n      <el-form ref=\"addDialogForm\" label-width=\"80px\" label-position=\"left\"\r\n        :model=\"addDialogForm\" :rules=\"addDialogRules\">\r\n        <el-form-item label=\"名称\" prop=\"name\">\r\n          <el-input v-model=\"addDialogForm.name\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"缩略图\" prop=\"thumbnail\">\r\n          <el-button @click=\"mediaDialgVisible = true\">从媒体库选择</el-button>\r\n          <span class=\"margin-left\" v-if=\"currentSelectMedia\">已选择</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"价格\" prop=\"price\">\r\n          <el-input v-model.number=\"addDialogForm.price\">\r\n            <span slot=\"append\">元</span>\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\">\r\n        <el-button type=\"primary\" :loading=\"addDialogLoading\" @click=\"addDialogConfirm\">确定</el-button>\r\n        <el-button @click=\"addDialogVisible = false\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n    <!-- 添加产品弹窗END -->\r\n\r\n    <!-- 产品编辑弹窗 -->\r\n    <el-dialog title=\"编辑产品\" :visible.sync=\"editDialogVisible\" append-to-body\r\n      @closed=\"editDialogCloseHandler\">\r\n      <el-form ref=\"editDialogForm\" label-width=\"80px\" label-position=\"left\"\r\n        :model=\"editDialogForm\" :rules=\"editDialogRules\">\r\n        <el-form-item label=\"名称\" prop=\"name\">\r\n          <el-input v-model=\"editDialogForm.name\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"缩略图\" prop=\"thumbnail\">\r\n          <el-button @click=\"mediaDialgVisible = true\">从媒体库选择</el-button>\r\n          <span class=\"margin-left\" v-if=\"currentSelectMedia\">已选择</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"价格\" prop=\"price\">\r\n          <el-input v-model.number=\"editDialogForm.price\">\r\n            <span slot=\"append\">元</span>\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\">\r\n        <el-button type=\"primary\" :loading=\"editDialogLoading\" @click=\"editDialogConfirm\">保存</el-button>\r\n        <el-button @click=\"editDialogVisible = false\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n    <!-- 产品编辑弹窗END -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport moment from 'moment'\r\nimport LeeMedia from './Media'\r\n\r\nexport default {\r\n  name: 'Product',\r\n  components: {\r\n    LeeMedia\r\n  },\r\n  data() {\r\n    return {\r\n      page: 1,\r\n      pagesize: 10,\r\n      total: 0,\r\n      list: [],\r\n      loading: false,\r\n      selection: [],\r\n\r\n      currentSelectMedia: null,\r\n      mediaDialgVisible: false,\r\n\r\n      addDialogVisible: false,\r\n      addDialogForm: {\r\n        name: '',\r\n        price: 0\r\n      },\r\n      addDialogRules: {\r\n        name: [{ required: true, message: '请填写产品名称' }],\r\n        price: [{ required: true, message: '请填写产品价格' }]\r\n      },\r\n      addDialogLoading: false,\r\n\r\n      editDialogVisible: false,\r\n      editDialogForm: {\r\n        name: '',\r\n        price: 0\r\n      },\r\n      editDialogRules: {\r\n        name: [{ required: true, message: '请填写产品名称' }],\r\n        price: [{ required: true, message: '请填写产品价格' }]\r\n      },\r\n      editDialogLoading: false,\r\n      editProductId: null\r\n    }\r\n  },\r\n  async created() {\r\n    await this.getProductList(1)\r\n  },\r\n  methods: {\r\n    mediaDialogConfirm() {\r\n      const media = this.$refs.media\r\n      this.currentSelectMedia = media.selection[0] || null\r\n      this.mediaDialgVisible = false\r\n    },\r\n\r\n    // 添加产品\r\n    async addDialogConfirm() {\r\n      if (this.addDialogLoading) return\r\n      if (!await this.$refs.addDialogForm.validate()) return\r\n      this.addDialogLoading = true\r\n      const { name, price } = this.addDialogForm\r\n      const { currentSelectMedia } = this\r\n      const { data: res } = await this.$http.post('/product/add', {\r\n        name,\r\n        price: Math.ceil(price * 100),\r\n        thumbnail: currentSelectMedia && currentSelectMedia._id\r\n      })\r\n      this.addDialogLoading = false\r\n      if (res.status !== 'ok') {\r\n        return this.$message.error(res.errmsg)\r\n      }\r\n      this.$message.success('添加成功')\r\n      this.addDialogVisible = false\r\n      await this.getProductList(1)\r\n    },\r\n\r\n    // 产品列表\r\n    async getProductList(page = 1) {\r\n      this.loading = true\r\n      const { data: res } = await this.$http.post('/product/list', {\r\n        page: Math.max(1, page),\r\n        pagesize: this.pagesize\r\n      })\r\n      this.loading = false\r\n      if (res.status === 'ok') {\r\n        this.page = res.data.page\r\n        this.pagesize = res.data.pagesize\r\n        this.list = res.data.list.slice(0)\r\n        this.total = res.data.total\r\n        this.selection = []\r\n      }\r\n    },\r\n\r\n    // 格式化价格\r\n    priceFormatter(item) {\r\n      return `￥${item.price / 100}`\r\n    },\r\n    // 格式化日期\r\n    dateFormatter(item) {\r\n      return moment(item.createdAt).format('YYYY/MM/DD')\r\n    },\r\n\r\n    // 选中产品\r\n    selectionChangeHandler(selection) {\r\n      this.selection = selection\r\n    },\r\n\r\n    // 删除产品\r\n    removeProducts(list) {\r\n      const products = list.map(v => v._id)\r\n      if (products.length === 0) return\r\n      this.$confirm('是否删除选中的产品？', '删除确认', {\r\n        type: 'warning',\r\n        callback: async action => {\r\n          if (action !== 'confirm') return\r\n          this.loading = true\r\n          const { data: res } = await this.$http.post('/product/remove', {\r\n            products\r\n          })\r\n          this.loading = false\r\n          if (res.status !== 'ok') {\r\n            return this.$message.error(res.errmsg)\r\n          }\r\n          this.$message.success('删除成功')\r\n          await this.getProductList(\r\n            this.list.length === 1 ? this.page - 1 : this.page\r\n          )\r\n        }\r\n      })\r\n    },\r\n\r\n    // 编辑产品弹窗确认\r\n    async editDialogConfirm() {\r\n      if (!this.editProductId) return\r\n      if (this.editDialogLoading) return\r\n      if (!await this.$refs.editDialogForm.validate()) return\r\n      this.editDialogLoading = true\r\n      const { name, price } = this.editDialogForm\r\n      const { currentSelectMedia } = this\r\n      const { data: res } = await this.$http.post('/product/update', {\r\n        _id: this.editProductId,\r\n        modify: {\r\n          name,\r\n          price: Math.ceil(price * 100),\r\n          thumbnail: currentSelectMedia && currentSelectMedia._id\r\n        }\r\n      })\r\n      this.editDialogLoading = false\r\n      if (res.status !== 'ok') {\r\n        return this.$message.error(res.errmsg)\r\n      }\r\n      this.$message.success('更新成功');\r\n      this.editDialogVisible = false\r\n      await this.getProductList(this.page)\r\n    },\r\n\r\n    // 打开编辑产品弹窗\r\n    openEditDialog(item) {\r\n      this.editDialogForm.name = item.name\r\n      this.editDialogForm.price = item.price / 100\r\n      this.currentSelectMedia = item.thumbnail\r\n      this.editProductId = item._id\r\n      this.editDialogVisible = true\r\n    },\r\n\r\n    // 添加产品弹窗关闭\r\n    addDialogCloseHandler() {\r\n      this.currentSelectMedia = null\r\n      this.$refs.addDialogForm.resetFields()\r\n    },\r\n    // 编辑产品弹窗关闭\r\n    editDialogCloseHandler() {\r\n      this.editProductId = null\r\n      this.currentSelectMedia = null\r\n      this.$refs.editDialogForm.resetFields()\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Product.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Product.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Product.vue?vue&type=template&id=f27dde20&scoped=true&\"\nimport script from \"./Product.vue?vue&type=script&lang=js&\"\nexport * from \"./Product.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f27dde20\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}